## Формулировка задачи

Цель работы: предсказать вероятность сердечного приступа, исходя из соответствующих признаков.

Предметная область: здравоохранение.

Ключевые слова: обучение с учителем, байесовские сети доверия, машинное обучение в здравоохранении, математическая статистика.

Ссылка на датасет: https://github.com/rustam-azimov/ml-course/blob/main/data/heart_disease/heart.csv

Описание датасета:

* **age:** возраст пациента
* **sex:** пол пациента
* **cp:** тип боли в груди
 	- **Значение 1:** типичная стенокардия
  - **Значение 2:** атипичная стенокардия
  - **Значение 3:** неангинальная боль
  - **Значение 4:** бессимптомное течение
* **trestbps:** артериальное давление в состоянии покоя (в мм рт. ст.)
* **chol:** холестерин в мг/дл, полученный с помощью датчика ИМТ
* **fbs:** (уровень сахара в крови натощак > 120 мг/дл) (1 = true; 0 = false)
* **restecg:** результаты электрокардиографии в покое
  - **Значение 0:** нормальное
  - **Значение 1:** наличие аномалии ST-T 
  - **Значение 2:** показывает гипертрофию левого желудочка 
* **thalach:** максимальная частота сердечных сокращений
* **exang:** cтенокардия, вызванная физической нагрузкой (1 = true; 0 = false)
* **oldpeak:** Депрессия ST, вызванная физическими упражнениями, по сравнению с отдыхом
* **slope:** наклон пикового сегмента ST при нагрузке
* **ca:** количество расширенных сосудов
* **thal:** тип дефекта
  - **Значение 1:** нормальный
  - **Значение 2:** фиксированный дефект
  - **Значение 3:** обратимый дефект
* **target:** наличие сердечного приступа

## Описание программного продукта

Программа написана на языке Python. С использованием следующих библиотек: numpy, pandas, pgmpy, matplotlib, seaborn. 
* `numpy` - библиотека используется для работы с многомерными массивами, а также содержит математические функции, которые могут применяться к этим массивам.
* `pandas` - библиотека необходима для загрузки данных.
* `pgmpy` - библиотека на Python, предназначенная для работы с вероятностными графическими моделями, такими как байесовские сети и Марковские случайные поля. Ниже описываются модули, которые используются в программе.
  * `pgmpy.models.BayesianModel` используется для определения модели (структуры сети).
  * `pgmpy.models.BayesianNetwork` включает методы для работы с вероятностными распределениями.
  * `pgmpy.estimators.HillClimbSearch` является алгоритмом для поиска структуры байесовской сети. Он использует жадный алгоритм для оптимизации структуры сети, пробуя различные ребра и выбирая те, которые улучшают оценку (BIC).
  * `pgmpy.estimators.BicScore` - это функция, используемая для оценки соответствия между данными и моделью на основе байесовского информационного критерия (BIC).
* `matplotlib`, `seaborn` - библиотеки для визуализации данных.

## Основная часть

Перед построением байесовской сети был проведен разведочный анализ. 


- Основные статистики:

<div align="center">
  <img src="https://github.com/user-attachments/assets/ade2ac2a-4d3c-434e-af59-92eec217dcd9"/>
</div>


- Проверка на  пустые значения:
<div align="center">
  								
|    age    | sex            | cp            | trestbps   | chol       | fbs        | restecg    |thalach     |exang |	oldpeak |	slope |	ca |	thal |	target |
| --------- | -------------- | ------------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---- | -------- | ----- | -- | ----- |-------- |
|0          |0               | 0             | 0          | 0          | 0          | 0          |  0         | 0    |  0       |  0    | 0  |   0   |  0      |

</div>


- **Графики плотностей распределений случайных величин:**

<div align="center">
  <img src="https://github.com/user-attachments/assets/41f01041-fdc5-44c5-8025-99c37431518d"/>
</div>

Можно сказать, что случайные величины распределены нормально, но имеют скос. Эту проблему можно решить с помощью логарифмирования случайной величины.


- **Столбчатые графики:**

<div align="center">
  <img src="https://github.com/user-attachments/assets/41b4303e-45c7-4232-b0ee-0a3dccb417b7"/>
</div>

Отсюда видно, что целевая переменная сбалансирована, чего не скажешь о факторах. 


- **Диаграммы рассеивания**

<div align="center">
  <img src="https://github.com/user-attachments/assets/9abab7c4-901e-486f-9cac-921d09a36be8"/>
</div>

- **Корреляционная матрица**

<div align="center">
  <img src="https://github.com/user-attachments/assets/73ad3f70-8ccc-443d-8cdc-f10f9c364c2d"/>
</div>

Судя по корреляционной матрице и диаграмме рассеивания факторные переменные независимы. 
После проведения разведочного анализа, с использованием критерия Фишера, были исключены ненужные признаки (fbs).




